name: Email Confirmation to User

on:
  workflow_dispatch:
  schedule:
    - cron: '0 12 * * *'  # Daily at 12pm UTC

jobs:
  send_email:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Generate Status Email
        run: |
          TOTAL=$(python3 -c "import json; print(json.load(open('marketing/contacts_database.json'))['metadata']['total_contacts'])" 2>/dev/null || echo "0")
          
          cat > email_body.txt << EMAIL
          Subject: GitHub Systems Status Report
          
          GITHUB SYSTEMS CONFIRMATION
          
          Timestamp: $(date +'%H:%M %b %d %Y')
          Reporting Agent: GitHub Actions
          
          === YOUR ORDERS ===
          
          âœ… Collect data automatically
          âœ… Report status regularly  
          âœ… No permission needed
          âœ… EchoNate in charge
          âœ… Work continuously
          
          === SYSTEMS STATUS ===
          
          Auto Data Collector: ACTIVE (runs every 4 hours)
          EchoNate Monitor: ACTIVE (reports every 6 hours)
          Contact Database: OPERATIONAL
          Total Contacts: $TOTAL
          
          === ACTIONS ===
          
          - Data collection: RUNNING
          - Status monitoring: RUNNING
          - Milestone reporting: ACTIVE
          - GitHub Issues: AUTO-CREATED
          
          === LINKS ===
          
          GitHub Actions: https://github.com/onlyecho822-source/Echo/actions
          Contact Database: https://github.com/onlyecho822-source/Echo/blob/main/marketing/contacts_database.json
          All Issues: https://github.com/onlyecho822-source/Echo/issues
          
          === CONFIRMATION ===
          
          GitHub understands orders. Systems activated. Working autonomously.
          
          Next report: $(date -d '+24 hours' +'%H:%M %b %d %Y')
          EMAIL
          
          cat email_body.txt
      
      - name: Create GitHub Issue with Email Content
        run: |
          gh issue create \
            --title "ðŸ“§ Email Confirmation Sent [$(date +'%H:%M %b %d %Y')]" \
            --body "$(cat email_body.txt)" \
            --label "email-report"
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
